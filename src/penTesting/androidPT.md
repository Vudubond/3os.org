# Android Penetration Testing

## ADB Over Network/Wifi

Connect your mobile device via USB and make sure usb debugging is on (you can do that via the developer options in your device). Also connect to your Wifi.

Open up the Terminal , provided you have the adb set in your PATH, type the following, this would list your device as connected over the USB

```bash
adb devices
```

To enable the wifi-debug-mode

```bash
adb tcpip 5555
```

**IMPORTANT : Remove USB Cable**
Connect your device by typing in the below in the terminal

```bash
adb connect DEVICE-IP-ADDRESS:5555

```

## Frida Server for SSL Pinning Bypass

Requirements:

- Rooted Adnroid Phone
- Python 3
- pip(pip3)

Install Frida framework, objection to your host

```bash
pip3 install frida-tools
pip3 install objection
```

Download [Frida Server](https://github.com/frida/frida/releases)
Extract and Rename the file to _frida-server_
Move the file to the Adnroid Phone to **/data/local/tmp/**

Connect to adb shell to the android device

```bash
adb shell
```

Change to Root

```bash
su
```

Check if you are root

```bash
whoami
```

Change permissions to the /data/local/tmp/frida-server to be able to run the server

```bash
chmod 755 /data/local/tmp/frida-server
```

Run the Frida Server in background:

```bash
/data/local/tmp/frida-server &
```

Go Back to Host Terminal
List all the Applications and find the name of the desired application you want to by bypass SSL Pinning

```bash
frida-ps -Ua
```

Now Run with the name of the application

```bash
objection -g c**********n explore -q
```

Now remove the SSL Pining with

```bash
android sslpinning disable
```

## mobFS Docker

change -v path according to your system

```bash
docker run \
-d \
-it \
-v /root/tools/mobSF:/root/.MobSF \
-h mobsf \
--name mobsf \
--restart always \
-e TZ=Asia/Jerusalem \
-p 50000:8000 \
opensecurity/mobile-security-framework-mobsf:latest
```

## Tools

| Tools                                              | Description                                      |
| -------------------------------------------------- | ------------------------------------------------ |
| [APK Tool](https://ibotpeaches.github.io/Apktool/) | A tool for reverse engineering Android apk files |

## How to Singe APK After Compile

Install __apksigner__

```bash
apt install -y apksigner
```

Create certificate at the same folder you've compiled your modified APK

```bash
keytool -genkey -v -keystore keystore.jks -keyalg RSA -keysize 2048 -validity 10000
```

Enter A password (we will need it to singe the APK), enter any data you wish for the certificate information. At the end enter __'y'__ at the end to create the certificate.

Now we should have 2 files: your.apk, keystore.jks. The only step left is to singe the APK with new certificate.

```bash
apksigner sign --ks keystore.jks your.apk
```

When installing the APK you will be prompted with a warning of "unknown certificate" just hit Install.

## Apps For Penetration Testing

| Android Application                                                                                                                                | Description                                 |
|----------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
| [Network Analyzer](https://play.google.com/store/apps/details?id=net.techet.netanalyzerlite.an)                                                    | Network Analyzer                            |
| [Packet Capture](https://www.apkmirror.com/apk/grey-shirts/packet-capture/packet-capture-1-4-7-release/packet-capture-1-4-7-android-apk-download/) | Packet capture/Network traffic sniffer      |
| [Root Explorer](https://play.google.com/store/apps/details?id=com.speedsoftware.rootexplorer)                                                      | File Manager for Root Users (Root Required) |
| [Material Terminal](https://play.google.com/store/apps/details?id=yarolegovich.materialterminal&hl=en)                                             | Terminal                                    |
